# DKonsole Configuration
# Only configure what you need. Leave the rest as default.

# -----------------------------------------------------------------------------
# 1. Ingress / External Access (REQUIRED for external access)
# -----------------------------------------------------------------------------
ingress:
  enabled: true
  className: "nginx"
  # Ingress annotations (e.g., for cert-manager)
  # Example:
  #   cert-manager.io/cluster-issuer: "letsencrypt-prod"
  #   nginx.ingress.kubernetes.io/ssl-redirect: "true"
  annotations: {}
  hosts:
    - host: dkonsole.lan
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: dkonsole-tls
      hosts:
        - dkonsole.lan

# Allowed Origins for WebSocket (CORS)
# Comma-separated list of allowed origins (e.g., "https://dkonsole.lan,http://localhost:5173")
# If empty, only same-origin requests are allowed.
# IMPORTANT: For setup mode to work via ingress, include your ingress URL here
# Example: "https://dkonsole.lan"
allowedOrigins: "https://dkonsole.lan"

# -----------------------------------------------------------------------------
# 2. Docker Image Configuration
# -----------------------------------------------------------------------------
image:
  repository: dkonsole/dkonsole
  tag: "1.4.1"
  pullPolicy: Always

# Image pull secrets (optional)
# Example: [{"name": "myregistrykey"}]
imagePullSecrets: []

# Name override for the release (optional)
nameOverride: ""

# Full name override for the release (optional)
fullnameOverride: ""

# -----------------------------------------------------------------------------
# 3. Initial Setup (Web Interface)
# -----------------------------------------------------------------------------
# DKonsole uses "Setup Mode" for initial configuration.
# No authentication values are needed in Helm - setup is done via web interface.
#
# Installation process:
#   1. Deploy the Helm chart (no authentication values needed)
#   2. Access the web interface via ingress
#   3. Complete the setup form to create the admin account
#   4. The secret will be created automatically in Kubernetes
#   5. After setup, you can login with the credentials you configured
#
# The secret name follows the pattern: {release-name}-auth
# Example: If release name is "dkonsole", secret will be "dkonsole-auth"

# -----------------------------------------------------------------------------
# 4. Service Account Configuration
# -----------------------------------------------------------------------------
serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# -----------------------------------------------------------------------------
# 5. Pod Configuration
# -----------------------------------------------------------------------------
# Pod annotations (optional)
podAnnotations: {}

# Pod Security Context (Run as non-root user)
podSecurityContext:
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 2000

# Container Security Context (optional)
securityContext: {}

# -----------------------------------------------------------------------------
# 6. Service Configuration
# -----------------------------------------------------------------------------
service:
  type: ClusterIP
  port: 8080

# -----------------------------------------------------------------------------
# 7. Replica Configuration
# -----------------------------------------------------------------------------
replicaCount: 1

# -----------------------------------------------------------------------------
# 8. Resource Limits and Requests
# -----------------------------------------------------------------------------
resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi

# -----------------------------------------------------------------------------
# 9. Autoscaling Configuration (Optional)
# -----------------------------------------------------------------------------
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80

# -----------------------------------------------------------------------------
# 10. Node Selection and Scheduling
# -----------------------------------------------------------------------------
# Node selector (optional)
nodeSelector: {}

# Tolerations (optional)
tolerations: []

# Affinity rules (optional)
affinity: {}

# -----------------------------------------------------------------------------
# 11. Prometheus Integration (Optional)
# -----------------------------------------------------------------------------
# Configure the Prometheus endpoint to enable historical metrics for Pods
# If not set, the Metrics tab will not be displayed in Pod details
# Example: "http://prometheus-server.monitoring.svc.cluster.local:9090"
# Features enabled:
#   - Historical CPU and memory metrics for Pods
#   - Time range selector (1h, 6h, 12h, 1d, 7d, 15d)
#   - Metrics tab in Pod details view
prometheusUrl: ""

# -----------------------------------------------------------------------------
# 12. RBAC Permissions (Required for dashboard functionality)
# -----------------------------------------------------------------------------
# FULL ACCESS to ALL resources (both cluster-scoped and namespaced) - allows importing ANY Kubernetes resource via YAML
rbac:
  create: true
  # Cluster-wide resources - FULL ACCESS to create/update/delete cluster-scoped resources
  # This allows importing ClusterRole, ClusterRoleBinding, PersistentVolume, StorageClass, etc.
  clusterResources:
    - apiGroups: ["*"]
      resources: ["*"]
      verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  nonResourceURLs:
    - "*"
  # Namespaced resources - FULL ACCESS to all resources in all API groups
  # This allows importing ANY Kubernetes resource via YAML
  namespacedResources:
    - apiGroups: ["*"]
      resources: ["*"]
      verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
