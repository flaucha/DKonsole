{"fields.level":"warning","level":"warning","msg":"Generated random JWT_SECRET for non-production (set JWT_SECRET to persist sessions)","time":"2025-12-13T11:58:32.337-03:00","type":"warn"}
=== RUN   TestK8sEventRepository_GetEvents_Success
--- PASS: TestK8sEventRepository_GetEvents_Success (0.00s)
=== RUN   TestK8sEventRepository_GetEvents_Error
--- PASS: TestK8sEventRepository_GetEvents_Error (0.00s)
=== RUN   TestExecService_CreateExecutor
=== RUN   TestExecService_CreateExecutor/Success
=== RUN   TestExecService_CreateExecutor/Executor_Creation_Fail
--- PASS: TestExecService_CreateExecutor (0.00s)
    --- PASS: TestExecService_CreateExecutor/Success (0.00s)
    --- PASS: TestExecService_CreateExecutor/Executor_Creation_Fail (0.00s)
=== RUN   TestExecService_RequestStructure
--- PASS: TestExecService_RequestStructure (0.00s)
=== RUN   TestExecService_Security_NoCommandInjection
--- PASS: TestExecService_Security_NoCommandInjection (0.00s)
=== RUN   TestExecService_ValidationIntegration
--- PASS: TestExecService_ValidationIntegration (0.00s)
=== RUN   TestService_ExecIntoPod_Mocked
=== RUN   TestService_ExecIntoPod_Mocked/ExecIntoPod_Success
{"container":"c1","level":"info","msg":"WebSocket upgraded successfully","pod":"default/pod-1","time":"2025-12-13T11:58:32.339-03:00","type":"info"}
=== RUN   TestService_ExecIntoPod_Mocked/ExecIntoPod_Missing_Params
=== RUN   TestService_ExecIntoPod_Mocked/ExecIntoPod_Cluster_Client_Error
=== RUN   TestService_ExecIntoPod_Mocked/ExecIntoPod_Forbidden
=== RUN   TestService_ExecIntoPod_Mocked/ExecIntoPod_Message_Filtering
{"container":"c1","level":"info","msg":"WebSocket upgraded successfully","pod":"default/pod-1","time":"2025-12-13T11:58:32.341-03:00","type":"info"}
=== RUN   TestService_ExecIntoPod_Mocked/ExecIntoPod_Allowed_Origins
{"container":"c1","level":"info","msg":"WebSocket upgraded successfully","pod":"default/pod-1","time":"2025-12-13T11:58:32.392-03:00","type":"info"}
{"error":"websocket: request origin not allowed by Upgrader.CheckOrigin","host":"127.0.0.1:36985","level":"error","message":"WebSocket upgrade failed","msg":"WebSocket upgrade failed","origin":"https://malicious.com","pod":"default/pod-1","time":"2025-12-13T11:58:32.393-03:00","type":"error"}
--- PASS: TestService_ExecIntoPod_Mocked (0.05s)
    --- PASS: TestService_ExecIntoPod_Mocked/ExecIntoPod_Success (0.00s)
    --- PASS: TestService_ExecIntoPod_Mocked/ExecIntoPod_Missing_Params (0.00s)
    --- PASS: TestService_ExecIntoPod_Mocked/ExecIntoPod_Cluster_Client_Error (0.00s)
    --- PASS: TestService_ExecIntoPod_Mocked/ExecIntoPod_Forbidden (0.00s)
    --- PASS: TestService_ExecIntoPod_Mocked/ExecIntoPod_Message_Filtering (0.05s)
    --- PASS: TestService_ExecIntoPod_Mocked/ExecIntoPod_Allowed_Origins (0.00s)
=== RUN   TestSetWebSocketCORSHeaders
--- PASS: TestSetWebSocketCORSHeaders (0.00s)
=== RUN   TestSetWebSocketCORSHeaders_NoOrigin
--- PASS: TestSetWebSocketCORSHeaders_NoOrigin (0.00s)
=== RUN   TestK8sLogRepository_GetLogStream
--- PASS: TestK8sLogRepository_GetLogStream (0.00s)
=== RUN   TestLogService_StreamLogs
=== RUN   TestLogService_StreamLogs/successful_log_stream
=== RUN   TestLogService_StreamLogs/stream_logs_with_follow
=== RUN   TestLogService_StreamLogs/stream_logs_with_container_specified
=== RUN   TestLogService_StreamLogs/repository_error
=== RUN   TestLogService_StreamLogs/stream_logs_with_container_and_follow
--- PASS: TestLogService_StreamLogs (0.00s)
    --- PASS: TestLogService_StreamLogs/successful_log_stream (0.00s)
    --- PASS: TestLogService_StreamLogs/stream_logs_with_follow (0.00s)
    --- PASS: TestLogService_StreamLogs/stream_logs_with_container_specified (0.00s)
    --- PASS: TestLogService_StreamLogs/repository_error (0.00s)
    --- PASS: TestLogService_StreamLogs/stream_logs_with_container_and_follow (0.00s)
=== RUN   TestDefaultFactories
--- PASS: TestDefaultFactories (0.00s)
=== RUN   TestStreamPodLogs_InvalidParams
--- PASS: TestStreamPodLogs_InvalidParams (0.00s)
=== RUN   TestStreamPodLogs_Forbidden
--- PASS: TestStreamPodLogs_Forbidden (0.00s)
=== RUN   TestGetPodEvents_Forbidden
--- PASS: TestGetPodEvents_Forbidden (0.00s)
=== RUN   TestExecIntoPod_PermissionDenied
--- PASS: TestExecIntoPod_PermissionDenied (0.00s)
=== RUN   TestStreamPodLogs_ClientError
--- PASS: TestStreamPodLogs_ClientError (0.00s)
=== RUN   TestStreamPodLogs_Success
--- PASS: TestStreamPodLogs_Success (0.00s)
=== RUN   TestExecIntoPod_MissingClient
--- PASS: TestExecIntoPod_MissingClient (0.00s)
=== RUN   TestExecIntoPod_MissingRESTConfig
--- PASS: TestExecIntoPod_MissingRESTConfig (0.00s)
=== RUN   TestExecIntoPod_SuccessWithMockExecutor
{"container":"","level":"info","msg":"WebSocket upgraded successfully","pod":"ns1/pod1","time":"2025-12-13T11:58:32.395-03:00","type":"info"}
--- PASS: TestExecIntoPod_SuccessWithMockExecutor (0.00s)
=== RUN   TestGetPodEvents_Success
--- PASS: TestGetPodEvents_Success (0.00s)
=== RUN   TestGetPodEvents_RepoError
--- PASS: TestGetPodEvents_RepoError (0.00s)
=== RUN   TestGetPodEvents_InvalidParams
--- PASS: TestGetPodEvents_InvalidParams (0.00s)
=== RUN   TestGetPodEvents_ClientError
--- PASS: TestGetPodEvents_ClientError (0.00s)
=== RUN   TestStreamPodLogs_AuthError
--- PASS: TestStreamPodLogs_AuthError (0.00s)
=== RUN   TestPodService_GetPodEvents
=== RUN   TestPodService_GetPodEvents/successful_events_retrieval
=== RUN   TestPodService_GetPodEvents/empty_events_list
=== RUN   TestPodService_GetPodEvents/repository_error
=== RUN   TestPodService_GetPodEvents/events_sorted_by_LastSeen_(most_recent_first)
--- PASS: TestPodService_GetPodEvents (0.00s)
    --- PASS: TestPodService_GetPodEvents/successful_events_retrieval (0.00s)
    --- PASS: TestPodService_GetPodEvents/empty_events_list (0.00s)
    --- PASS: TestPodService_GetPodEvents/repository_error (0.00s)
    --- PASS: TestPodService_GetPodEvents/events_sorted_by_LastSeen_(most_recent_first) (0.00s)
PASS
ok  	github.com/flaucha/DKonsole/backend/internal/pod	0.072s
